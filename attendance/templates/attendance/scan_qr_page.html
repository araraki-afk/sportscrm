{% extends 'attendance/base.html' %}
{% block title %}Сканировать QR{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center">{{ section_time.section.name }}</h1>
    <h3 class="text-center">Время: {{ section_time.start_time }} - {{ section_time.end_time }}</h3>

    <div class="text-center my-5">
        <h4>Сканируйте QR-код</h4>
        <div id="reader" style="width: 100%; max-width: 500px; margin: 0 auto;"></div>
        <p id="scan-result" class="mt-3 text-success"></p>
    </div>
</div>

<!-- Подключаем библиотеку html5-qrcode -->
<script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>

<script>
    function onScanSuccess(decodedText, decodedResult) {
        document.getElementById('scan-result').innerHTML = `Код найден: ${decodedText}`;

        window.location.href = decodedText;
    }

    const html5QrcodeScanner = new Html5QrcodeScanner(
        "reader", { fps: 10, qrbox: 250 }
    );
    html5QrcodeScanner.render(onScanSuccess);
</script>
{% endblock %}

